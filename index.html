<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Don Retos ‚Äî Juego de fiesta</title>
  <meta name="description" content="Don Retos: el juego de fiesta para adultos. Retos, qu√≠mica, intensidad y modo responsable. Marca: Iv√°n Barca." />

  <style>
    :root{
      --bg0:#050516;
      --bg1:#020617;
      --txt:#ffffff;
      --muted:rgba(255,255,255,.72);
      --muted2:rgba(255,255,255,.56);
      --stroke:rgba(255,255,255,.14);
      --violet:#7C3AED;
      --purple:#9333EA;
      --magenta:#E100FF;
      --pink:#EC4899;
      --green:#22C55E;
      --yellow:#FACC15;
      --shadow: 0 18px 46px rgba(0,0,0,.55);
      --radius: 22px;
      --max: 1120px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Helvetica Neue";
      color:var(--txt);
      background: linear-gradient(180deg, var(--bg0), var(--bg1));
      overflow-x:hidden;
    }

    /* Fondo reactivo (se ajusta por JS con --night y --glow) */
    body::before{
      content:"";
      position:fixed; inset:0;
      pointer-events:none;
      background:
        radial-gradient(1200px 600px at 20% 0%, rgba(124,58,237, var(--glow, .30)), transparent 55%),
        radial-gradient(900px 500px at 90% 10%, rgba(225,0,255, var(--glow2, .18)), transparent 55%),
        radial-gradient(900px 600px at 50% 100%, rgba(236,72,153, var(--glow3, .14)), transparent 55%),
        linear-gradient(180deg, rgba(0,0,0, var(--night, .10)), rgba(0,0,0, var(--night2, .25)));
      transition: .25s ease;
      z-index:-2;
    }

    a{color:inherit; text-decoration:none}
    .wrap{max-width:var(--max); margin:0 auto; padding:0 18px}
    .nav{
      position:sticky; top:0; z-index:30;
      backdrop-filter: blur(14px);
      background: rgba(5,5,22,.55);
      border-bottom: 1px solid rgba(255,255,255,.08);
    }
    .nav-inner{
      display:flex; align-items:center; justify-content:space-between;
      height:64px;
      gap:12px;
    }
    .brand{display:flex; align-items:center; gap:10px; font-weight:950; letter-spacing:.2px}
    .logo{
      width:36px; height:36px; border-radius:12px;
      background: linear-gradient(135deg, var(--violet), var(--pink));
      box-shadow: 0 10px 24px rgba(124,58,237,.35);
      position:relative;
      overflow:hidden;
    }
    .logo::after{
      content:"";
      position:absolute; inset:-40px;
      background: conic-gradient(from 220deg, rgba(124,58,237,0), rgba(225,0,255,.22), rgba(124,58,237,0));
      filter: blur(10px);
      animation: spin 7s linear infinite;
    }
    @keyframes spin{to{transform:rotate(360deg)}}

    .nav-links{display:flex; gap:14px; color:var(--muted2); font-weight:800; font-size:14px}
    .nav-links a{padding:8px 10px; border-radius:999px}
    .nav-links a:hover{color:var(--txt); background: rgba(255,255,255,.06)}
    .btn{
      display:inline-flex; align-items:center; justify-content:center;
      gap:10px;
      padding:12px 16px;
      border-radius:16px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color:var(--txt);
      font-weight:950;
      box-shadow: 0 10px 28px rgba(0,0,0,.35);
      transition: transform .12s ease, background .12s ease, filter .12s ease;
      cursor:pointer;
      user-select:none;
    }
    .btn:hover{transform: translateY(-1px); background: rgba(255,255,255,.09)}
    .btn:active{transform: translateY(0px) scale(.99)}
    .btn.primary{
      border:none;
      background: linear-gradient(135deg, var(--violet), var(--purple), var(--magenta));
      box-shadow: 0 14px 36px rgba(124,58,237,.40);
    }
    .btn.primary:hover{filter:saturate(1.08)}
    .btn.small{padding:10px 12px; border-radius:14px; font-size:13px}
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:6px 10px;
      border-radius:999px;
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.12);
      color: var(--muted);
      font-size:12px;
      font-weight:900;
    }
    .pill b{
      background: linear-gradient(90deg, var(--green), var(--yellow));
      -webkit-background-clip:text;
      background-clip:text;
      color:transparent;
    }

    main{position:relative}
    .hero{padding:54px 0 18px}
    .grid{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:18px;
      align-items:stretch;
    }
    @media (max-width: 900px){
      .grid{grid-template-columns: 1fr}
      .nav-links{display:none}
    }

    .card{
      border: 1px solid rgba(255,255,255,.10);
      background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.04));
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
    }
    .card::after{
      content:"";
      position:absolute; inset:-120px;
      background: radial-gradient(circle at 40% 30%, rgba(124,58,237,.22), transparent 60%),
                  radial-gradient(circle at 80% 20%, rgba(236,72,153,.18), transparent 60%);
      filter: blur(18px);
      pointer-events:none;
      opacity:.55;
    }
    .hero-card{padding:22px}
    h1{
      margin:12px 0 10px;
      font-size:44px;
      line-height:1.05;
      letter-spacing:-.7px;
      position:relative;
      z-index:1;
    }
    .grad{
      background: linear-gradient(90deg, #fff, rgba(255,255,255,.9), rgba(177,151,255,.95), rgba(225,0,255,.85));
      -webkit-background-clip:text;
      background-clip:text;
      color:transparent;
    }
    .sub{
      color: var(--muted);
      font-size:15px;
      line-height:1.5;
      margin:0 0 16px;
      max-width: 58ch;
      position:relative;
      z-index:1;
    }
    .cta{display:flex; gap:12px; flex-wrap:wrap; margin-top:10px; position:relative; z-index:1}
    .mini{
      margin-top:14px;
      display:flex; gap:10px; flex-wrap:wrap;
      color: var(--muted2);
      font-weight:800;
      font-size:13px;
      position:relative;
      z-index:1;
    }
    .mini span{
      padding:8px 10px;
      border-radius:999px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
    }

    .preview{padding:18px; display:flex; flex-direction:column; gap:12px}
    .mock{
      height: 260px;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.12);
      background:
        radial-gradient(320px 160px at 30% 20%, rgba(124,58,237,.35), transparent 60%),
        radial-gradient(320px 160px at 80% 30%, rgba(236,72,153,.26), transparent 60%),
        linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      position:relative;
      overflow:hidden;
      z-index:1;
    }
    .mock::after{
      content:"";
      position:absolute; inset:-40px;
      background: conic-gradient(from 220deg, rgba(124,58,237,.0), rgba(225,0,255,.18), rgba(124,58,237,.0));
      filter: blur(10px);
      animation: spin 7s linear infinite;
    }
    .mock-inner{
      position:absolute; inset:14px;
      border-radius: 14px;
      background: rgba(0,0,0,.28);
      border: 1px solid rgba(255,255,255,.12);
      display:flex; flex-direction:column; justify-content:center; align-items:center;
      text-align:center;
      padding:14px;
      z-index:2;
    }
    .mock-inner .big{font-weight:950; font-size:20px}
    .mock-inner .small{
      margin-top:6px;
      color: var(--muted);
      font-weight:800;
      font-size:13px;
      line-height:1.35;
      max-width: 36ch;
    }

    section{padding:18px 0}
    .section-title{font-size:20px; font-weight:950; margin:0 0 10px; letter-spacing:.2px}
    .section-sub{color:var(--muted); margin:0 0 14px; line-height:1.55}
    .cols{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:12px;
    }
    @media (max-width: 900px){ .cols{grid-template-columns:1fr} }

    .tile{
      padding:14px;
      border-radius: 18px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      position:relative;
      overflow:hidden;
    }
    .tile:hover{border-color: rgba(255,255,255,.18)}
    .tile h3{margin:8px 0 6px; font-size:15px; font-weight:950}
    .tile p{margin:0; color:var(--muted); font-size:13px; line-height:1.45}
    .emoji{font-size:20px}

    .hr{height:1px; background: rgba(255,255,255,.10); margin:18px 0}

    /* Intensidad UI */
    .intensity{
      display:flex; flex-direction:column; gap:8px;
      margin-top:14px;
      padding:12px;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
      position:relative;
      z-index:1;
    }
    .intensity-head{
      display:flex; align-items:center; justify-content:space-between;
      font-weight:950;
      color: rgba(255,255,255,.86);
      font-size:13px;
    }
    .bar{
      height: 12px;
      border-radius: 999px;
      background: rgba(255,255,255,.10);
      overflow:hidden;
      border:1px solid rgba(255,255,255,.10);
    }
    .bar > div{
      height:100%;
      width:0%;
      border-radius:999px;
      background: linear-gradient(90deg, var(--violet), var(--purple), var(--magenta), var(--pink));
      transition: width .28s ease;
      box-shadow: 0 12px 30px rgba(124,58,237,.35);
    }
    .hint{color:var(--muted2); font-weight:800; font-size:12px; line-height:1.35}

    /* Card game */
    .tap-card{
      margin-top:12px;
      padding:24px;
      border-radius:18px;
      background: linear-gradient(135deg,#7C3AED,#EC4899);
      font-weight:950;
      text-align:center;
      cursor:pointer;
      transition:.18s ease;
      border:1px solid rgba(255,255,255,.18);
      user-select:none;
    }
    .tap-card:hover{transform: translateY(-1px)}
    .tap-card:active{transform: translateY(0px) scale(.99)}
    .shake{animation: shake .35s ease}
    @keyframes shake{
      0%,100%{transform:translateX(0)}
      25%{transform:translateX(-6px)}
      50%{transform:translateX(6px)}
      75%{transform:translateX(-4px)}
    }

    /* Locked */
    .locked-box{
      margin-top:14px;
      padding:14px;
      border-radius:18px;
      background: rgba(255,255,255,.05);
      border: 1px solid rgba(255,255,255,.12);
      text-align:center;
    }
    .censored{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      letter-spacing: .8px;
      opacity:.9;
    }

    /* Toast */
    .toast{
      position:fixed;
      left:50%;
      bottom:22px;
      transform:translateX(-50%);
      padding:12px 14px;
      border-radius: 16px;
      background: rgba(0,0,0,.55);
      border:1px solid rgba(255,255,255,.14);
      backdrop-filter: blur(12px);
      box-shadow: 0 16px 40px rgba(0,0,0,.55);
      color: rgba(255,255,255,.90);
      font-weight:900;
      font-size:13px;
      opacity:0;
      pointer-events:none;
      transition: .22s ease;
      z-index:999;
    }
    .toast.show{opacity:1; transform:translateX(-50%) translateY(-6px)}

    /* confetti canvas overlay */
    #confetti{
      position:fixed;
      inset:0;
      pointer-events:none;
      z-index:80;
    }

    .footer{
      padding:22px 0 34px;
      color: var(--muted2);
      font-size:13px;
    }
    .footer a{color: rgba(177,151,255,.95); font-weight:900}
    .legal-links{display:flex; gap:10px; flex-wrap:wrap; margin-top:10px}
  </style>
</head>

<body>
  <canvas id="confetti"></canvas>

  <div class="nav">
    <div class="wrap nav-inner">
      <div class="brand" id="brandTap" title="Tip: toca 5 veces üëÄ">
        <div class="logo" aria-hidden="true"></div>
        <div>Don Retos <span style="opacity:.6">‚Äî</span> <span style="opacity:.88">Iv√°n Barca</span></div>
      </div>

      <div class="nav-links">
        <a href="#funciona">C√≥mo funciona</a>
        <a href="#packs">Packs</a>
        <a href="#seguridad">Modo responsable</a>
        <a href="#legal">Legal</a>
      </div>

      <a class="btn primary" href="#descargar" onclick="beep(); pop(10)">Obtener</a>
    </div>
  </div>

  <main class="wrap">
    <div class="hero">
      <div class="grid">
        <div class="card hero-card">
          <div class="pill">üçæ <b>Fiesta responsable</b> ¬∑ Juego para adultos</div>

          <h1><span class="grad">Don Retos</span><br/>la noche sube de nivel.</h1>

          <p class="sub">
            Elige packs, a√±ade jugadores y deja que la app maneje la tensi√≥n:
            de ‚Äúrompehielos‚Äù a ‚Äútodo o nada‚Äù. Esta p√°gina NO es un folleto: puedes
            jugar una mini-demo ahora mismo.
          </p>

          <div class="cta" id="descargar">
            <a class="btn primary" href="#" onclick="toast('Aqu√≠ ir√° tu link de Google Play cuando te aprueben ‚úÖ'); beep(); pop(12); return false;">Google Play</a>
            <a class="btn" href="#" onclick="toast('App Store requiere Mac/Xcode y cuenta Apple ‚úÖ'); beep(); return false;">App Store</a>
            <a class="btn" href="#demo" onclick="beep();">Jugar demo</a>
          </div>

          <div class="mini">
            <span>‚ö° Intensidad real</span>
            <span>üéâ Confetti</span>
            <span>üîê +21 bloqueado</span>
          </div>

          <!-- Intensidad -->
          <div class="intensity">
            <div class="intensity-head">
              <div>Intensidad de la noche</div>
              <div><span id="pct">0</span>%</div>
            </div>
            <div class="bar"><div id="barFill"></div></div>
            <div class="hint" id="hint">Tip: juega la demo y sube el % para desbloquear el modo +21.</div>

            <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:6px">
              <button class="btn small" onclick="setIntensity(intensity+15); beep(); pop(10)">+15%</button>
              <button class="btn small" onclick="setIntensity(intensity-10); beep(520,0.05)">-10%</button>
              <button class="btn small" onclick="resetIntensity(); beep(300,0.06)">Reset</button>
            </div>
          </div>
        </div>

        <div class="card preview">
          <div class="mock" aria-hidden="true">
            <div class="mock-inner">
              <div class="big">Tu screenshot aqu√≠</div>
              <div class="small">Sube 3‚Äì5 capturas reales en tu repo y reemplaza este bloque por im√°genes.</div>
            </div>
          </div>

          <div class="tile">
            <div class="emoji">üî•</div>
            <h3>Intensidad que reacciona</h3>
            <p>El fondo se ‚Äúoscurece‚Äù y brilla m√°s seg√∫n tu porcentaje. S√≠: se siente vivo.</p>
          </div>
        </div>
      </div>
    </div>

    <div class="hr"></div>

    <!-- DEMO -->
    <section id="demo">
      <h2 class="section-title">Demo jugable (mini)</h2>
      <p class="section-sub">Toca, genera retos, sube intensidad y desbloquea lo prohibido üòà</p>

      <div class="cols">
        <div class="tile">
          <div class="emoji">üé≤</div>
          <h3>Reto r√°pido</h3>
          <p id="quickChallenge">Toca ‚ÄúDame uno‚Äù para empezar.</p>
          <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:10px">
            <button class="btn primary" onclick="newChallenge()">Dame uno</button>
            <button class="btn" onclick="passChallenge()">Paso üòÖ</button>
          </div>
        </div>

        <div class="tile">
          <div class="emoji">üÉè</div>
          <h3>Carta misteriosa</h3>
          <p>Tap para revelar. Cada tap sube la noche.</p>
          <div id="card" class="tap-card" onclick="flipCard()">TOCA PARA REVELAR</div>
          <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:10px">
            <button class="btn small" onclick="superFlip()">Modo Caos ‚ö°</button>
            <button class="btn small" onclick="beep(); boom(80)">Confetti</button>
          </div>
        </div>

        <div class="tile">
          <div class="emoji">üîû</div>
          <h3>Zona bloqueada (+21)</h3>
          <p class="censored" id="lockedText">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</p>

          <div class="locked-box">
            <div style="font-weight:950; margin-bottom:10px">Desbloqueo</div>
            <button class="btn primary" onclick="unlock()">Desbloquear</button>
            <button class="btn" onclick="toggle21(true)">Activar +21 (si est√° permitido)</button>
          </div>

          <p class="hint" style="margin-top:10px">
            Regla: si tu intensidad est√° baja, no te deja. Si subes el %‚Ä¶ aparece.
          </p>
        </div>
      </div>
    </section>

    <section id="funciona">
      <h2 class="section-title">C√≥mo funciona</h2>
      <p class="section-sub">En 20 segundos ya est√°s jugando. Sin complicarte, pero con control.</p>

      <div class="cols">
        <div class="tile">
          <div class="emoji">üéõÔ∏è</div>
          <h3>1) Elige packs</h3>
          <p>Mezcla niveles (suave / qu√≠mica / extremo) y arma tu noche.</p>
        </div>
        <div class="tile">
          <div class="emoji">‚è±Ô∏è</div>
          <h3>2) Define duraci√≥n</h3>
          <p>10‚Äì40 min. La app gestiona turnos y ritmo.</p>
        </div>
        <div class="tile">
          <div class="emoji">üë•</div>
          <h3>3) Agrega jugadores</h3>
          <p>Con apodos. Se elige al azar qui√©n recibe el reto.</p>
        </div>
      </div>
    </section>

    <section id="packs">
      <h2 class="section-title">Packs (niveles)</h2>
      <p class="section-sub">Dise√±ados para escalar. En tu app real puedes ajustar los textos como quieras.</p>

      <div class="cols">
        <div class="tile">
          <div class="emoji">‚ùÑÔ∏è</div>
          <h3>Nivel 1 ‚Äî Calentamiento</h3>
          <p>Rompehielos, coqueteo suave, risas sin presi√≥n.</p>
        </div>
        <div class="tile">
          <div class="emoji">üòà</div>
          <h3>Nivel 2 ‚Äî Qu√≠mica fuerte</h3>
          <p>Tensi√≥n, atrevimiento, ‚Äúa ver qui√©n se anima‚Äù.</p>
        </div>
        <div class="tile">
          <div class="emoji">üí£</div>
          <h3>Nivel 3 ‚Äî Extremo +18</h3>
          <p>Solo para valientes. Retos intensos, cero filtro.</p>
        </div>
      </div>
    </section>

    <section id="seguridad">
      <h2 class="section-title">Modo responsable</h2>
      <p class="section-sub">La regla #1 es el consentimiento. Si alguien no quiere, se salta y punto.</p>

      <div class="cols">
        <div class="tile">
          <div class="emoji">üß†</div>
          <h3>Consentimiento</h3>
          <p>‚ÄúNo‚Äù es ‚Äúno‚Äù. Sin presi√≥n social. Sin burlas.</p>
        </div>
        <div class="tile">
          <div class="emoji">üçª</div>
          <h3>Alcohol</h3>
          <p>Si hay alcohol, cada uno decide y se cuida. No es obligaci√≥n.</p>
        </div>
        <div class="tile">
          <div class="emoji">üîû</div>
          <h3>Contenido adulto</h3>
          <p>+18 / +21 puede ir bloqueado con aviso y reglas claras.</p>
        </div>
      </div>
    </section>

    <section id="legal">
      <h2 class="section-title">Legal y contacto</h2>
      <p class="section-sub">
        Marca: <b>Iv√°n Barca</b> ¬∑ Ecuador ¬∑ Contacto: <b>ivanbarcamafia@gmail.com</b>
      </p>

      <div class="tile">
        <div style="font-weight:950">Documentos</div>
        <div class="legal-links">
          <a class="btn" href="https://ivanbarcamafia-ctrl.github.io/don-retos-legal/" target="_blank" rel="noreferrer" onclick="beep(); pop(10)">Centro legal</a>
          <a class="btn" href="mailto:ivanbarcamafia@gmail.com" onclick="beep()">Escribir email</a>
        </div>
        <p style="margin:12px 0 0; color:var(--muted); font-size:13px; line-height:1.5">
          
        </p>
      </div>
    </section>

    <div class="footer">
      ¬© <span id="y"></span> Don Retos ¬∑ Iv√°n Barca ‚Äî El hermano que siempre necesitaste.
    </div>
  </main>

  <div class="toast" id="toast"></div>

  <script>
    // A√±o
    document.getElementById("y").textContent = new Date().getFullYear();

    // ======== Intensidad (0..100) ========
    let intensity = 0;
    let modo21 = false;

    const pctEl = document.getElementById("pct");
    const fillEl = document.getElementById("barFill");
    const hintEl = document.getElementById("hint");

    function clamp(n, a, b){ return Math.max(a, Math.min(b, n)); }

    function setIntensity(value){
      intensity = clamp(Math.round(value), 0, 100);
      pctEl.textContent = intensity;
      fillEl.style.width = intensity + "%";

      // Fondo reactivo: m√°s intensidad = m√°s noche + m√°s glow
      const t = intensity / 100;
      document.body.style.setProperty("--night", (0.06 + t*0.25).toFixed(3));
      document.body.style.setProperty("--night2", (0.18 + t*0.40).toFixed(3));
      document.body.style.setProperty("--glow", (0.22 + t*0.40).toFixed(3));
      document.body.style.setProperty("--glow2", (0.12 + t*0.30).toFixed(3));
      document.body.style.setProperty("--glow3", (0.10 + t*0.28).toFixed(3));

      if(intensity >= 90){
        hintEl.textContent = "üî• Est√°s en modo peligro. Si desbloqueas +21‚Ä¶ no hay vuelta atr√°s.";
      }else if(intensity >= 70){
        hintEl.textContent = "üòà Ya est√°s cerca. Desbloquea +21 cuando quieras.";
      }else if(intensity >= 35){
        hintEl.textContent = "üëÄ Est√° subiendo‚Ä¶ ahora s√≠ se siente.";
      }else{
        hintEl.textContent = "Tip: juega la demo y sube el % para desbloquear el modo +21.";
      }

      // Auto celebraciones
      if(intensity === 100){
        boom(140);
        toast("100% ‚Äî La noche est√° fuera de control üí£");
        beep(980, 0.06);
      }
    }

    function resetIntensity(){
      setIntensity(0);
      modo21 = false;
      toast("Reset. Vuelve a empezar üòá");
    }

    // Inicial
    setIntensity(0);

    // ======== Retos / demo ========
    const challenges = [
      "Mira a alguien del grupo durante 5 segundos sin hablar.",
      "Di algo que normalmente no dir√≠as en voz alta.",
      "Elige a alguien y dile un secreto falso (con cara seria).",
      "Cambia de lugar con la persona que menos conoces.",
      "Sonr√≠e sin raz√≥n durante 10 segundos.",
      "Haz un brindis por la persona m√°s peligrosa aqu√≠.",
      "Elige a alguien: hoy te debe una confesi√≥n.",
      "Mira a alguien y di: ‚Äút√∫ y yo‚Ä¶ luego hablamos‚Äù.",
      "Pregunta: ‚Äú¬øqui√©n aqu√≠ tiene el secreto m√°s oscuro?‚Äù"
    ];

    function newChallenge(){
      const c = challenges[Math.floor(Math.random()*challenges.length)];
      document.getElementById("quickChallenge").textContent = c;
      setIntensity(intensity + 8);
      pop(12);
      beep(880,0.05);
    }

    function passChallenge(){
      document.getElementById("quickChallenge").textContent =
        "üëÄ Pasar tambi√©n cuenta‚Ä¶ pero la noche lo recuerda.";
      setIntensity(intensity + 4);
      beep(520,0.05);
    }

    const cardTexts = [
      "Elige a alguien que te intrigue.",
      "Haz una pregunta inc√≥moda (sin explicar por qu√©).",
      "Decide qui√©n manda la pr√≥xima ronda.",
      "Di: ‚Äúok‚Ä¶ ahora s√≠ empieza lo bueno‚Äù.",
      "Esto se est√° poniendo interesante‚Ä¶",
      "Se acab√≥ el modo t√≠midos.",
      "Todos miran a alguien. Nadie dice por qu√©."
    ];

    function flipCard(){
      const el = document.getElementById("card");
      el.textContent = cardTexts[Math.floor(Math.random()*cardTexts.length)];
      el.style.transform = "scale(1.05)";
      setTimeout(()=>el.style.transform="scale(1)",150);
      setIntensity(intensity + 10);
      pop(18);
      beep(920,0.05);
    }

    function superFlip(){
      const el = document.getElementById("card");
      el.classList.remove("shake");
      void el.offsetWidth;
      el.classList.add("shake");
      flipCard();
      setIntensity(intensity + 12);
      boom(90);
      toast("Modo Caos ‚ö° (solo por hoy)");
      beep(1040,0.06);
    }

    // ======== +21 ========
    function toggle21(showToast){
      if(intensity < 70){
        toast("A√∫n no. Sube la intensidad a 70%+ üòà");
        beep(420,0.06);
        return;
      }
      modo21 = true;
      if(showToast) toast("Modo +21 ACTIVADO üî•");
      beep(980,0.06);
      pop(20);
      updateLockedText();
    }

    function updateLockedText(){
      const el = document.getElementById("lockedText");
      if(!modo21){
        el.textContent = "‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà";
      }else{
        el.textContent = "‚úÖ +21 activado ‚Äî En la app real esto muestra packs extra.";
      }
    }

    function unlock(){
      if(intensity < 70){
        const el = document.getElementById("lockedText");
        el.textContent = "A√∫n no‚Ä¶ sube la intensidad üòà";
        pop(12);
        beep(420,0.06);
        return;
      }
      modo21 = true;
      updateLockedText();
      boom(120);
      toast("Desbloqueado. Ahora s√≠‚Ä¶ üî•");
      beep(980,0.06);
    }

    // Tap secreto en la marca: 5 taps para activar +21 si intensidad >=70
    let tapCount = 0;
    const brandTap = document.getElementById("brandTap");
    brandTap.addEventListener("click", () => {
      tapCount++;
      if(tapCount >= 5){
        tapCount = 0;
        if(modo21){
          modo21 = false;
          updateLockedText();
          toast("Modo +21 desactivado");
          beep(520,0.05);
        }else{
          toggle21(true);
        }
      }else{
        beep(700, 0.03);
      }
    });

    // ======== Micro feedback: confetti + pop ========
    const canvas = document.getElementById("confetti");
    const ctx = canvas.getContext("2d");
    let W = 0, H = 0;
    function resize(){
      W = canvas.width = window.innerWidth * devicePixelRatio;
      H = canvas.height = window.innerHeight * devicePixelRatio;
    }
    window.addEventListener("resize", resize);
    resize();

    let particles = [];
    function boom(count=100){
      for(let i=0;i<count;i++){
        particles.push({
          x: (window.innerWidth/2 + (Math.random()*260-130)) * devicePixelRatio,
          y: (window.innerHeight*0.18 + (Math.random()*90)) * devicePixelRatio,
          vx: (Math.random()*8-4) * devicePixelRatio,
          vy: (Math.random()*-10-6) * devicePixelRatio,
          g: (0.35 + Math.random()*0.25) * devicePixelRatio,
          r: (3 + Math.random()*4) * devicePixelRatio,
          a: 1,
          rot: Math.random()*6.28,
          vr: (Math.random()*0.25-0.125)
        });
      }
    }

    function loop(){
      ctx.clearRect(0,0,W,H);
      for(let i=particles.length-1;i>=0;i--){
        const p = particles[i];
        p.vy += p.g;
        p.x += p.vx;
        p.y += p.vy;
        p.a -= 0.010;
        p.rot += p.vr;

        // colores random entre violeta/pink/blanco
        const pick = i % 3;
        ctx.save();
        ctx.globalAlpha = Math.max(p.a,0);
        ctx.translate(p.x, p.y);
        ctx.rotate(p.rot);
        ctx.fillStyle = pick===0 ? "#7C3AED" : pick===1 ? "#EC4899" : "#FFFFFF";
        ctx.fillRect(-p.r, -p.r, p.r*2, p.r*2);
        ctx.restore();

        if(p.a <= 0 || p.y > H + 40*devicePixelRatio) particles.splice(i,1);
      }
      requestAnimationFrame(loop);
    }
    loop();

    // Pop: mini ‚Äúgolpe‚Äù visual (animaci√≥n r√°pida)
    function pop(amount=12){
      // peque√±o pulso en el fill de la barra
      fillEl.style.filter = "brightness(1.35)";
      setTimeout(()=>fillEl.style.filter="brightness(1.0)",120);
      // un poco de confetti si sube fuerte
      if(amount >= 15) boom(60);
    }

    // ======== Toast ========
    const toastEl = document.getElementById("toast");
    let toastTimer = null;
    function toast(msg){
      toastEl.textContent = msg;
      toastEl.classList.add("show");
      clearTimeout(toastTimer);
      toastTimer = setTimeout(()=>toastEl.classList.remove("show"), 1700);
    }

    // ======== Sonidito (sin archivos) ========
    let audioCtx = null;
    function beep(freq=880, dur=0.045){
      try{
        audioCtx = audioCtx || new (window.AudioContext || window.webkitAudioContext)();
        const o = audioCtx.createOscillator();
        const g = audioCtx.createGain();
        o.type = "triangle";
        o.frequency.value = freq;
        g.gain.value = 0.06;
        o.connect(g); g.connect(audioCtx.destination);
        o.start();
        o.stop(audioCtx.currentTime + dur);
      }catch(e){}
    }
  </script>
</body>
</html>
